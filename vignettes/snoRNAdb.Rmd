---
title: "Loading snoRNAdb data"
author: "Felix G.M. Ernst"
date: "`r Sys.Date()`"
output:
  BiocStyle::html_document:
    toc: true
    toc_float: true
    df_print: paged
vignette: >
  %\VignetteIndexEntry{snoRNAdb.data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

To compare samples, we need to define, which positions should be part of the
comparison. This can either be done by aggregating the detected modifications
over all samples and use the union or intersect or by using publish data. 
We want to assemble a GRanges object from the latter. 

For this We will load a table containg the published data from the snoRNAdb 
[[@Lestrade.2006]](#References) and assemble the GRanges object.

```{r, echo=FALSE}
suppressPackageStartupMessages({
  library(GenomicFeatures)
})
```

```{r}
library(GenomicFeatures)
table <- read.csv2(system.file("extdata","snoRNAdb.csv",
                               package = "RNAmodR.Data"),
                   stringsAsFactors = FALSE)
table[1:2,]
# keep only the current coordinates
table <- table[,1:7]
gr <- GRanges(seqnames = table$hgnc_symbol,
              ranges = IRanges(start = table$position, width = 1),strand = "+",
              type = "RNAMOD",
              mod = table$modification,
              Parent = table$hgnc_symbol,
              Activity = CharacterList(strsplit(table$guide,",")))
# convert to current gene name
gr <- gr[vapply(gr$Activity != "unknown",all,logical(1)),]
coord <- split(gr,gr$Parent)
head(coord)
```

# References<a name="References"></a>